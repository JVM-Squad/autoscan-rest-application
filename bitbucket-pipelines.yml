image: openjdk:14

pipelines:
  default:
    - step:
        name: Build software
        caches:
          - gradle
        script:
          - bash ./gradlew check
          - pipe: sonarsource/sonarcloud-scan:1.2.1
            variables:
              EXTRA_ARGS: -Dsonar.projectName="FinTrack REST API" -Dsonar.projectKey="FinTrack:API" -Dsonar.organization="jongsoft"
        after-script:
          - bash ./gradlew codeCoverageReport
          - bash <(curl -s https://codecov.io/bash) -f ./build/reports/jacoco/report.xml
